#!/usr/sbin/nft -f
# File: element.nft
# Description: A test NFT file to exercise 'element' m syntax highlightings.
#
# base_cmd add_cmd 'element' 
# base_cmd create_cmd 'element' 
# base_cmd destroy_cmd 'element' 
# base_cmd delete_cmd 'element' 
# base_cmd get_cmd 'element' 
# base_cmd reset_cmd 'element' 
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################

# base_cmd add_cmd 'set'

# set_expr->set_block_expr->'element'->add_cmd->base_cmd->line
element T S { };
element last C { };
element T last { };
element last last { };
element ip T S { };
element ip6 T S { };
element inet T S { };
element netdev T S { };
element bridge T S { };
element arp T S { };

# variable_expr->set_block_expr->'element'->add_cmd->base_cmd->line
element ip T last $MY_ELEMENT;
element ip T S $MY_ELEMENT ;

# set_expr->set_block_expr->'element'->add_cmd->'add'->base_cmd->line
# 'add element' only takes map key-value
# 'add element' will not take anonymous set (that occurs in 'rule'->set_expr, not 'add element')
element ip filter blocked_ips { 10.0.0.0/24, 8.8.8.8 timeout 10m comment "temporary host" }
element ip filter service_map { 1.2.3.4 : accept, 5.6.7.8 timeout 30s : drop comment "spam host" }


# variable_expr->set_block_expr->'element'->add_cmd->'add'->base_cmd->line
add element T S $MY_ELEMENT

add element T S { };

# set_expr->set_block_expr->'element'->create_cmd->'create'->base_cmd->line
create element T S { };
# variable_expr->set_block_expr->'element'->create_cmd->'create'->base_cmd->line
create element T S $MY_ELEMENT

# set_expr->set_block_expr->'element'->destroy_cmd->'destroy'->base_cmd->line
destroy element T S { };
# variable_expr->set_block_expr->'element'->destroy_cmd->'destroy'->base_cmd->line
destroy element T S $MY_ELEMENT

# set_expr->set_block_expr->'element'->get_cmd->'get'->base_cmd->line
get element T S { };
# variable_expr->set_block_expr->'element'->get_cmd->'get'->base_cmd->line
get element T S $MY_ELEM!NT

# set_expr->set_block_expr->'element'->reset_cmd->'reset'->base_cmd->line
reset element T S { };
# variable_expr->set_block_expr->'element'->reset_cmd->'reset'->base_cmd->line
reset element T S $MY_ELEMENT


################################################################################
# true negative test: properly hightlighted wrongly to show an error;
# so far, so good)
################################################################################


# 'element'->add_cmd->base_cmd->line
element 


# set_spec->'element'->add_cmd->base_cmd->line
element T 


element T S 


# explicit_family_spec->set_spec->'element'->add_cmd->base_cmd->line
element ip 


element TC { };
element lastC { };
element Tlast { };
element lastlast { };
element ipT S { };
element ip6 TC { };
element inet T C{ };

# variable_expr->set_block_expr->'element'->add_cmd->base_cmd->line
element T S { };
element ip T S $MY_ELEMENT

# set_block_expr->'element'->add_cmd->'add'->base_cmd->line
add element 


add element T 


add element T C



# set_block_expr->'element'->create_cmd->'create'->base_cmd->line
create 


create element 


create element T  


create element T S 



# set_block_expr->'element'->destroy_cmd->'destroy'->base_cmd->line
destroy 


destroy element 


destroy element T 



# set_block_expr->'element'->get_cmd->'get'->base_cmd->line
get 


get element 


get element T 


get element T E 



# set_block_expr->'element'->reset_cmd->'reset'->base_cmd->line
reset 


reset element 


reset element T 


reset element T S 



################################################################################
# false negative test: highlighted wrongly; still has good content; oops.
################################################################################


################################################################################
# false positive test: looks highlighted correctly; has bad content; oops.
################################################################################

elementT C;

element T S & 
element T S | 
element T S ( 
element T S ^  

add element T S &
add element T S |
add element T S (
add element T S ^

create element T S &
create element T S |
create element T S (
create element T S ^

destroy element T S &
destroy element T S |
destroy element T S (
destroy element T S ^

get element T S &
get element T S |
get element T S (
get element T S ^

reset element T S &
reset element T S |
reset element T S (
reset element T S ^

add set ip filter blocked_ips { elements = 192.168.1.5 }
