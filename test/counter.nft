#!/usr/sbin/nft -f
# File: counter.nft
# Description: A test NFT file to exercise 'counter' Vim syntax highlightings.
#
# bison symbol:   counter_stmt
# syntax pathway: counter_stmt->stateful_stmt->(stmt|stateful_stmt_list)
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################

counter table_id counter_id
counter table_id counter_id; 
counter table_id counter_id ;
counter table_id counter_id ; 
counter last counter_id
counter table_id last
counter last last
counter ip table_id counter_id
counter ip6 table_id counter_id;
counter inet table_id counter_id ;
counter netdev table_id counter_id; 
counter bridge table_id counter_id ; 
counter arp table_id counter_id
counter arp last counter_id
counter arp table_id last
counter arp last counter_id
counter arp last last

counter table_id counter_id packets 5 bytes 1500
counter table_id counter_id packets 5 bytes 1500; 
counter table_id counter_id packets 5 bytes 1500 ;
counter table_id counter_id packets 5 bytes 1500 ; 

counter table_id counter_id { packets 5 bytes 1500 }; 
counter table_id counter_id { packets 5 bytes 1500;}; 
counter table_id counter_id { packets 5 bytes 1500; }; 
counter table_id counter_id { packets 5 bytes 1500 ; }; 
counter table_id counter_id { packets 5 bytes 1500 } ;
counter table_id counter_id { packets 5 bytes 1500 } ;
counter table_id counter_id { packets 5 bytes 1500 } ; 

# inline comment
counter table_id counter_id { 
    # inline comments
    define A = 1  # inline comments
    redefine A = 2  # inline comments
    undefine A  # inline comments
    error; 
    packets 5 bytes 1500  # inline comments
    include "global_firewall.nft";
    include "lou_s_firewall.nft"
    comment "this stuff!`~@#$%^&*()_+-={}[]|\\:\"<>?/";
};

add counter ip table_id counter_id packets 5 bytes 1500
add counter ip table_id counter_id packets 5 bytes 1500;
add counter ip table_id counter_id packets 5 bytes 1500; 
add counter ip table_id counter_id packets 5 bytes 1500 ;
add counter ip table_id counter_id packets 5 bytes 1500 ; 

# 'counter' as a statement ('stmt')
add counter table_id counter_id   
add counter table_id counter_id;
add counter table_id counter_id; 
add counter table_id counter_id ;
add counter table_id counter_id ; 

add counter table_id counter_id { comment "Nice to say things" }

add counter table_id counter_id { packets 5 bytes 1500 };
add counter table_id counter_id { packets 5 bytes 1500 }; 
add counter table_id counter_id { packets 5 bytes 1500 } ;
add counter table_id counter_id { packets 5 bytes 1500 } ; 

add counter table_id counter_id { packets 5 bytes 1500 }; 
add counter table_id counter_id { packets 5 bytes 1500 } ;
add counter table_id counter_id { packets 5 bytes 1500 } ; 

add counter table_id counter_id { 
    define A = 1
    packets 5 bytes 1500
};

# 'counter' as an expression ('expr')
# counter_stmt->stateful_stmt->stateful_stmt_list->set_spec
# counter_stmt->stateful_stmt->(stmt|stateful_stmt_list)

add set T S { counter }
add set T S { counter } ;

add set T S { counter bytes 2048 }
add set T S { counter packets 3 }

# repeated stateful_stmt
add set T S { counter packets 3 counter packets 3 }


################################################################################
# true negative test: properly hightlighted wrongly to show an error; 
# so far, so good.
################################################################################

counterT ;

counter 


counter T 


counter T ; 

counter ip6tableid 


counter ip6 tableid counter_id

add set T S { counter marshmellows }
add set T S { counter bytes mss }
add set T S { counter packets once }


################################################################################
# false negative test: highlighted wrongly; still has good content; oops.
################################################################################

add counter ip table_id counter_id packets5 bytes 1500 ;
add counter ip table_id counter_id packets 5bytes 1500 ;
add counter ip table_id counter_id packets 5 bytes1500
add counter ip table_id counter_id packets 5 bytes1500 
add counter ip table_id counter_id packets 5 bytes1500 ;

add rule table_id chain_id set add { $MYVAR counter at  }

add counter table_id counter_id { packets5bytes1500 } ;
add counter ip table_id counter_id { packets5 bytes 1500 ; };
add counter ip table_id counter_id { packets 5bytes 1500 ; };
add counter ip table_id counter_id { packets 5 bytes1500 };
add counter ip table_id counter_id { packets 5 bytes 1500 ;
add counter ip t c { }  # it took a closing brace to turn off syntax error

add counter table_id counter_id { 
    define ABC = 1;
    comment "aasdfasdf"
    packets5bytes1500 
} ;
add counter table_id counter_id { 
    define ABC = 1;
    packets5bytes1500 
} ;
add counter ip table_id counter_id { 
    define ABC = 1;
    packets5 bytes 1500 ;
};
add counter ip table_id counter_id { 
    define ABC = 1;
    packets 5bytes 1500 ;
};
add counter ip table_id counter_id { 
    packets 5 bytes1500 
};


################################################################################
# false positive test: looks highlighted correctly; has bad content; oops.
################################################################################

