#!/usr/sbin/nft -f
# File: common_block.nft
# Description: A test NFT file to exercise common_block Vim syntax group.
#
# nft_line/nft_common_block
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################

;
  ;
 ;  

# line/common_block/INCLUDE
include "directory/filename.filetype"
# line/common_block/INCLUDE/stmt_separator
include "directory/filename.filetype";
include "directory/filename.filetype"; 
include "directory/filename.filetype" ;
include "directory/filename.filetype" ; 
# line common_block 'include' <QUOTED_STRING>
include "filespec"
include "filename.filetype"
include "directory/filename.filetype"
include "https://directory/filename.filetype"  # valid filespec but URL are not processed here (filesystem reject)
include "file:///directory/filename.filetype"  # valid filespec but URL are not processed here (filesystem reject)

# line common_block 'define' identifier '=' initializer_expr
# line/common_block/DEFINE
define A = 1
define last = 1
define ABC= 1  # missing stmt_separator
define ABC = 1  ;
define ABC = 1, 2, 3  ;  # set
define ABC = 127.0.0.1  # missing stmt_separator
define ABC = 127.0.0.1;
define ABC = 127.0.0.1, 192.168.1.1;  # set
define ABC =-1   # missing stmt_separator
define ABC = -1   # missing stmt_separator
define ABC = -1;
define ABC = -1; 
define ABC = -1 ;
define ABC = -1 ; 
define port_range = 1024-32767
define port_range = 1024-32767 ;
define ABC = identifier # missing stmt_separator
define ABC = identifier ;
define ABC = $identifier # missing stmt_separator
define ABC = $identifier;
define ABC = "string"  # missing stmt_separator
define ABC = "string";

# line/common_block/DEFINE/initializer_expr/rhs_expr/.../primary_rhs_expr/set_expr/{}
define ABC = {};
define last = {   }
define ABC = { }
define ABC = { }
define ABC = {            }

# Set section
define ABC = { 1 };
define MY_SET = { 1, 2 }
define MY_SET = { 1, 2, 3, 4 };

define MY_IP = { 127.0.0.1 };
define MY_IP_SET = { 127.0.0.1, 192.168.1.1, 192.168.10.10 };

define ABC = { x };
define MY_PORTS = { test };
define MY_PORTS_SET = { test, ssh, tcp, icmp };

define MY_DEV = { "eth0" };

define MY_DEV = { 1024-2048 };

# Map section
define MY_MAP = { 1:1 };
define MY_MAP = { 1:tcp };
define MY_MAP = { 1:"abc" };
define MY_MAP = { 1 : "abc" };
define MY_MAP = { 1:"eth0",  2:"br0" };
define MY_MAP = { tcp : tcp };
define MY_MAP = { eth0:127.0.0.1 };
define MY_MAP = { eth0 : 127.0.0.1 };
define MY_MAP = { eth0:127.0.0.1, bro0:192.168.1.1 };
define MY_MAP = { 192.168.20.20: ssh };
define MY_MAP = { 192.168.20.20: ssh, 127.0.0.1: http };
define MY_MAP = { 192.168.20.20: 127.0.0.1 };
define MY_MAP = { 192.168.20.20: 127.0.0.1, 127.0.0.1: 127.0.0.1};

# line/common_block/DEFINE/initializer_expr/DASH_NUM
define negative_value = -1000
define negative_value = -1000 ;
#
# line common_block 'redefine' identifier '=' initializer_expr
# line/common_block/REDEFINE
redefine last = {}
redefine A = {}
redefine A={}
redefine last = {}
redefine A = { 1 }
redefine A = { 1,2, 3, 4 }
redefine A = { 127.0.0.1 }
redefine A = { 127.0.0.1, 192.168.1.7 }
redefine A = { };
redefine A = { x }; 
redefine A = { } ;
redefine A = { } ; 
redefine A = 2
redefine A = 123  # missing stmt_separator
redefine A = -123  # missing stmt_separator
redefine A = $ABC  # missing stmt_separator

# line common_block 'undefine' identifier 
# line/common_block/UNDEFINE
undefine last
undefine last;
undefine last ;
undefine last; 
undefine last ; 
undefine A
undefine ABC
# line/common_block/UNDEFINE/stmt_separator
undefine A;
undefine A_BCDE;
undefine A123DF; 
undefine A123DG ;
undefine A123DH ; 

error
error;
  error;
error ;
    error ;
error ; 
error ; 

################################################################################
# true negative test: properly hightlighted wrongly to show an error;
# so far, so good)
################################################################################

oppsie


include ;

include 


# line/base_cmd/add_cmd/comment_spec
include V$DIR00/"direcetory/filename.filetype"  # inline comment line

defineA=1
define A 


define A x
define A & 1
define ABC = - 1 ;  # has a whitespace between dash '-' and a number

define A = 0- 1000  # whitespace NOT allowed in port-range
define A = 0 -1000  # whitespace NOT allowed in port-range
define A = 0 - 1000  # whitespace NOT allowed in port-range
define A = - 1000
define port_range = 1024-32767 oopsie

define last = { ,  }
define last = { $  }
define MY_MAP = { ,  2:"br0" };
define MY_DEV = { , "br0" }
define MY_DEV = { , "br0" };
define MY_DEV = { "eth0": 1 };
define MY_DEV_MAP = { "eth0", "br0": 3 };  # 1st element is not a map
define MY_MAP = { 192.168.20.20: ssh, 127.0.0.1: #http };
define PORT_RANGE = { 1024 - 2048 };
define PORT_RANGE = { 1024 -2048 };
define PORT_RANGE = { 1024- 2048 };

redefine A = { ;
redefine A = { 1,2, 3, 4; }
redefinelast { };

undefine 1BCDEF;
undefine A$BCDE;
undefine A`BCDE;
undefine A~BCDE;
undefine A!BCDE;
undefine A@BCDE;
undefine A#BCDE;
undefine A$BCDE;
undefine A%BCDE;
undefine A^BCDE;
undefine A&BCDE;
undefine A*BCDE;
undefine A(BCDE;
undefine A)BCDE;
undefine A-BCDE;
undefine A+BCDE;
undefine A[BCDE;
undefine A]BCDE;
undefine A|BCDE;
undefine A{BCDE;
undefine A}BCDE;
undefine A:BCDE;
undefine A'BCDE;
undefine A"BCDE;
undefine A<BCDE;
undefine A>BCDE;
undefine A,BCDE;
undefine A?BCDE;
undefine A\BCDE;
undefine A/BCDE;
undefine A.BCDE;
undefinelast

error  # inline comment line
error x 

################################################################################
# false negative test: highlighted wrongly; still has good content; oops.
################################################################################

include directory/"direcetory/filename.filetype"  # inline comment line


################################################################################
# false positive test: looks highlighted correctly; has bad content; oops.
################################################################################

define  ;
define A  
define A = 
define ABC = -1: 
define ABC = { x , };



define ABC = { 
   }

undefine $A123DH ; 
undefine & 
undefine $ 
undefine A;BCDE;

