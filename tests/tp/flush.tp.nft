#!/usr/sbin/nft -f
# File: flush.nft
# Description: Test NFT file to exercise 'flush' Vim syntax highlightings.
#
# base_cmd  flush_cmd
#

################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################
# Setup
add table T
add table ip Tip
add table ip6 Tip6
add table inet Tinet
add table netdev Tnetdev
add table bridge Tbridge
add table arp Tarp
add chain T C
add chain ip Tip Cip
add chain ip6 Tip6 Cip6
add chain inet Tinet Cinet
add chain netdev Tnetdev Cnetdev
add chain bridge Tbridge Cbridge
add chain arp Tarp Carp

flush table T
flush table ip Tip
flush table ip6 Tip6
flush table inet Tinet
flush table netdev Tnetdev
flush table bridge Tbridge
flush table arp Tarp

# Semicolon placements
flush table T;
flush table T;
flush table T ;
flush table T ;


flush chain T C
flush chain ip Tip Cip
flush chain ip6 Tip6 Cip6
flush chain inet Tinet Cinet
flush chain netdev Tnetdev Cnetdev
flush chain bridge Tbridge Cbridge
flush chain arp Tarp Carp

# semicolon placement, chain
flush chain T C;
flush chain T C;
flush chain T C ;
flush chain T C ;

# Setup map
map T M { flags timeout; timeout 1h; type ipv4_addr : verdict; };
map ip Tip Mip { flags timeout; timeout 1h; type ipv4_addr : verdict; };
map ip6 Tip6 Mip6 { flags timeout; timeout 1h; type ipv4_addr : verdict; };
map inet Tinet Minet { flags timeout; timeout 1h; type ipv4_addr : verdict; };
map netdev Tnetdev Mnetdev { flags timeout; timeout 1h; type ipv4_addr : verdict; };
map bridge Tbridge Mbridge { flags timeout; timeout 1h; type ipv4_addr : verdict; };
map arp Tarp Marp { flags timeout; timeout 1h; type ipv4_addr : verdict; };

# exercise 'flush map'
flush map T M
flush map ip Tip Mip
flush map ip6 Tip6 Mip6
flush map inet Tinet Minet
flush map netdev Tnetdev Mnetdev
flush map bridge Tbridge Mbridge
flush map arp Tarp Marp

# 'flush meter' is an invalid command (parser-OK, scanner-rejected)

flush ruleset 
flush ruleset ip 
flush ruleset ip6
flush ruleset inet




