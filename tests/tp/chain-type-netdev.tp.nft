
add table netdev T

add chain netdev T A { type filter hook ingress priority -500; policy accept; };
delete chain netdev T A { type filter hook ingress priority -500; policy accept; };

add chain netdev T A { type filter hook ingress device eno2 priority -500; policy accept; };
delete chain netdev T A { type filter hook ingress device eno2 priority -500; policy accept; };

add chain netdev T A { type filter hook ingress priority -500; policy accept; };
delete chain netdev T A { type filter hook ingress priority -500; policy accept; };

add chain netdev T A { type filter hook egress device eno2 priority -500; policy accept; };
delete chain netdev T A { type filter hook egress device eno2 priority -500; policy accept; };

add chain netdev T A { type route hook ingress priority 0; policy accept; };
delete chain netdev T A

add chain netdev T A { type route hook egress priority 0; policy accept; };
delete chain netdev T A

add chain netdev T A { type nat hook ingress priority 0; policy accept; };
delete chain netdev T A

add chain netdev T A { type nat hook egress priority 0; policy accept; };
delete chain netdev T A

# Passing Netdev priority labels
add chain netdev T A { type filter hook ingress device eno2 priority filter; policy accept; };
delete chain netdev T A

add chain netdev T A { type filter hook egress device eno2 priority filter; policy accept; };
delete chain netdev T A

add chain netdev T A { type route hook ingress device eno2 priority filter; policy accept; };
delete chain netdev T A

add chain netdev T A { type nat hook ingress device eno2 priority filter; policy accept; };
delete chain netdev T A

# Failing netdev type/hook combos
#add chain netdev T A { type filter hook prerouting priority 0; policy accept; };
#add chain netdev T A { type filter hook input priority 0; policy accept; };
#add chain netdev T A { type filter hook forward priority 0; policy accept; };
#add chain netdev T A { type filter hook output priority 0; policy accept; };
#add chain netdev T A { type filter hook postrouting priority 0; policy accept; };

#add chain netdev T A { type route hook prerouting priority 0; policy accept; };
#add chain netdev T A { type route hook input priority 0; policy accept; };
#add chain netdev T A { type route hook forward priority 0; policy accept; };
#add chain netdev T A { type route hook output priority 0; policy accept; };
#add chain netdev T A { type route hook postrouting priority 0; policy accept; };

#add chain netdev T A { type nat hook prerouting priority 0; policy accept; };
#add chain netdev T A { type nat hook input priority 0; policy accept; };
#add chain netdev T A { type nat hook forward priority 0; policy accept; };
#add chain netdev T A { type nat hook output priority 0; policy accept; };
#add chain netdev T A { type nat hook postrouting priority 0; policy accept; };

# Failing netdev priority labels
#add chain netdev T A { type filter hook ingress device eno2 priority security; policy accept; };
#add chain netdev T A { type filter hook ingress device eno2 priority dstnat; policy accept; };
#add chain netdev T A { type filter hook ingress device eno2 priority mangle; policy accept; };
#add chain netdev T A { type filter hook ingress device eno2 priority srcnat; policy accept; };
#add chain netdev T A { type filter hook ingress device eno2 priority raw; policy accept; };

#add chain netdev T A { type route hook ingress device eno2 priority out; policy accept; };
#add chain netdev T A { type route hook ingress device eno2 priority security; policy accept; };
#add chain netdev T A { type route hook ingress device eno2 priority dstnat; policy accept; };
#add chain netdev T A { type route hook ingress device eno2 priority mangle; policy accept; };
#add chain netdev T A { type route hook ingress device eno2 priority srcnat; policy accept; };
#add chain netdev T A { type route hook ingress device eno2 priority raw; policy accept; };
#add chain netdev T A { type filter hook ingress device eno2 priority out; policy accept; };

#add chain netdev T A { type nat hook ingress device eno2 priority out; policy accept; };
#add chain netdev T A { type nat hook ingress device eno2 priority security; policy accept; };
#add chain netdev T A { type nat hook ingress device eno2 priority dstnat; policy accept; };
#add chain netdev T A { type nat hook ingress device eno2 priority mangle; policy accept; };
#add chain netdev T A { type nat hook ingress device eno2 priority srcnat; policy accept; };
#add chain netdev T A { type nat hook ingress device eno2 priority raw; policy accept; };
