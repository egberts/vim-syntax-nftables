#!/usr/sbin/nft -f
# File: all-counter.nft
# Description: Test file to exercise '[add] counter' Vim syntax highlightings.
#
# nftables manpage shows:
#
#   {add | delete | destroy | list | reset} counter [family] table object
#   add counter [family] table name [{ [ packets packets bytes bytes ; ] [ comment comment ; }]
#   list counters
#   list counters [family]
#   delete counter [family] table name
#   delete counter [family] table handle handle
#   destroy counter [family] table handle handle
#   reset counters [family]
#
# Syntax Pathway:
#   base_cmd add_cmd 'counter'
#
# Semantic Actions (reverse parser_bison.y):
#   nft_line/nft_base_cmd/nft_base_cmd_add/nft_base_cmd_add_counter
#
################################################################################
# true positive test (properly hightlighted correctly; has good content; perfect)
################################################################################

# base_cmd add_cmd 'counter'

add table table_id
counter table_id counter_id
add counter table_id counter_id

# line->add_cmd->rule_position
add table T
add chain T C
counter T C


counter T C
add table T0
counter T0 C
add table T_
counter T_ C

counter T C/C

counter T C ;

add table ip T
add table ip6 T
add table inet T
add table netdev T
add table bridge T
add table arp T
counter ip T C
counter ip6 T C 
counter inet T C
counter netdev T C
counter bridge T C
counter arp T C

counter ip T C ;
counter ip6 T C ;
counter inet T C ; 
counter netdev T C;
counter bridge T C; 
counter arp T C  ;  




add counter T C0
add counter T C_
add counter T C\

add counter T last;

add counter T C ;

counter T last;


add counter filter http
add counter table_id counter_id


add counter filter https

add table filter
add chain filter input
add rule filter input tcp dport 80 counter name "http"  # nftables manpage ;
delete counter table_id counter_id

destroy counter table_id counter_id

add table table_id2
add counter table_id2 chain_id2
list counter table_id2 chain_id2
reset counter table_id counter_id
reset counter table_id  chain_id  ;
reset counter table_id2 chain_id2


table inet x {  # from nftables manpage
    chain y {
        type filter hook input priority filter; policy accept; ;;;;
        socket cgroupv2 level 1 "user.slice" counter
    }
}


