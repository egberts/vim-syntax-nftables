#!/usr/sbin/nft -f
# File: all-set.nft
# Description: A test NFT file to exercise '[add] set' Vim syntax highlightings.
#
# base_cmd add_cmd 'set'
# nft_line/nft_base_cmd/nft_base_cmd_add/nft_base_cmd_add_set
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################

# base_cmd add_cmd 'set'
table ip filter {
    set myset {
        type ipv4_addr
        elements = { 1.1.1.1 }
    }
}

# add_cmd 'set' set_block '{' 'ct' 'count'
add set nat S_CT_COUNT {
    type ipv4_addr
    ct count 15
    ct count over 15
}

# add_cmd 'set' set_block '{' 'last'
add set nat S_LAST_1 {
    type ipv4_addr
    last
}

# add_cmd 'set' set_block '{' 'last' 'used' 'never'
add set nat S_LAST_2 {
    type ipv4_addr
    last used never
}

# add_cmd 'set' set_block '{' 'last' 'used' <timeout>
add set nat S_LAST_3 {
    type ipv4_addr
    last used 2h5m30s
}

# add_cmd 'set' set_block '{' 'policy' 'memory'
add set nat S_FULL {
    type ipv4_addr
    policy memory  # set_mechanism
    size 1490
    comment "my comment string"
}

# add_cmd 'set' set_block '{' 'policy' 'performance'
add set nat S_FULL {
    type ipv4_addr
    policy performance  # set_mechanism
    size 1490
    comment "my comment string"
}

# add_cmd 'set' set_block '{'
add set nat S_FULL {
    type ipv4_addr
    # set-mechanism
    policy memory
    policy performance
    size 1490
    comment "my comment string"
}

