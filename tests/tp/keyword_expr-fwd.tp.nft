#!/usr/sbin/nft -f
# File: fwd.tp.nft
# Description: A false positive test NFT file to exercise 'fwd' keyword_expr Vim syntax highlightings.
# Kernel State: Active
# Libnftnl Access: FULL
# Root required: Yes
#
# 'fwd to' can only be used in:
#
#    Family:     ip/ip6
#    Chain type: filter
#    Hook:       forward
#
################################################################################
# true positive test (properly hightlighted correctly; has good content; perfect
################################################################################

flush ruleset
define FWD = eno2
add table ip Tip
add table ip6 Tip6
add table inet Tinet

add chain ip Tip Cip { type filter hook forward priority 0; policy accept; }
add chain ip6 Tip6 Cip6 { type filter hook forward priority 0; policy accept; }
add chain inet Tinet Cinet { type filter hook forward priority 0; policy accept; }

table ip Tip {
    chain Cip {
        type filter hook forward priority 0; policy accept;
        ip daddr 192.168.1.100 masquerade
    }
}
table netdev Tnetdev {
    chain Cnetdev {
        type filter hook ingress device wlo1 priority 0; policy accept;
        ip daddr 192.168.1.100 fwd to wlo1
    }
}


delete chain inet Tinet Cinet
delete chain ip6 Tip6 Cip6
delete chain ip Tip Cip

delete table inet Tinet
delete table ip6 Tip6
delete table ip Tip
