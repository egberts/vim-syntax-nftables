#!/usr/sbin/nft -f
# File: all-flowtable.nft
# Description: Test NFT file exercises '[add] flowtable' Vim syntax highlightings.
#
# base_cmd add_cmd 'flowtable' 
# nft_line/nft_base_cmd/nft_base_cmd_add/nft_base_cmd_add_flowtable
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect.
################################################################################


# ->flowtable_spec->'flowtable'->'delete'->delete_cmd->base_cmd
add table ip table_id
add table ip6 table_id
add table inet table_id
add table netdev table_id
add table bridge table_id
add table arp table_id

add flowtable ip table_id flowtable_id { hook ingress priority 0 ; devices = { eno2, wlo1 } ; }
add flowtable ip6 table_id flowtable_id { hook ingress priority 0 ; devices = { eno2, wlo1 } ; }
add flowtable inet table_id flowtable_id { hook ingress priority 0 ; devices = { eno2, wlo1 } ; }

delete flowtable ip table_id flowtable_id
delete flowtable ip6 table_id flowtable_id
delete flowtable inet table_id flowtable_id

# flowtableid_spec->'flowtable'->'destroy'->destroy_cmd->base_cmd
destroy flowtable table_id handle 15 
destroy flowtable ip table_id handle 15 
destroy flowtable ip6 table_id handle 15 
destroy flowtable inet table_id handle 15 
destroy flowtable netdev table_id handle 15 
destroy flowtable bridge table_id handle 15 
destroy flowtable arp table_id handle 15 

# ->flowtable_spec->'flowtable'->'destroy'->destroy_cmd->base_cmd
destroy flowtable table_id flowtable_id 
destroy flowtable ip table_id flowtable_id 
destroy flowtable ip6 table_id flowtable_id 
destroy flowtable inet table_id flowtable_id 
destroy flowtable netdev table_id flowtable_id 
destroy flowtable bridge table_id flowtable_id 
destroy flowtable arp table_id flowtable_id 

# ruleset_spec->'tables'->'flow'->list_cmd->base_cmd
list flow tables ip
list flow tables ip6
list flow tables inet

# ruleset_spec->'flowtables'->'list'->list_cmd->base_cmd
list flowtables
list flowtables ip
list flowtables ip6
list flowtables inet

# flowtable_spec->'flowtable'->'list'->list_cmd->base_cmd

add table ip6 T

# ruleset_spec->'tables'->'flow'->flush_cmd->base_cmd
add table table_id
# flush flow table table_id flow_id
# flush flow table ip table_id flow_id
# flush flow table ip6 table_id flow_id
# flush flow table inet table_id flow_id
# flush flow table netdev table_id flow_id
# flush flow table bridge table_id flow_id
# flush flow table arp table_id flow_id

# [https://wiki.nftables.org/wiki-nftables/index.php/Flowtables]
define DEV_PRIVATE=eth0
redefine DEV_PRIVATE =eth0
redefine DEV_PRIVATE= eth0
define DEV_INTERNET   =   eth1



