#!/usr/sbin/nft -f
# File: delete.nft
# Description: A test NFT file to exercise 'delete' Vim syntax highlightings.
#
# base_cmd 'delete' delete_cmd
# nft_line/nft_base_cmd/nft_base_cmd_add/nft_base_cmd_add_set
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################


add table ip Tip

# delete table <table_spec>
# 'table'->delete_cmd->'delete'->base_cmd->line
delete table Tip


add table ip Tip
delete table ip Tip

add table ip6 Tip6
delete table ip6 Tip6

add table inet Tinet
delete table inet Tinet

add table netdev Tnetdev
delete table netdev Tnetdev

add table bridge Tbridge
delete table bridge Tbridge

add table arp Tarp
delete table arp Tarp

add table ip Tip2
add table ip6 Tip6_2
add table inet Tinet2
add table netdev Tnetdev2
add table bridge Tbridge2
add table arp Tarp2


# delete chain <chainid_spec>
# common_block->chain_block->'{'->'chain'->delete_cmd->'delete'->base_cmd->line
add table Tchain
add table ip TchainIp
add table ip6 TchainIp6
add table inet TchainInet
add table netdev TchainNetdev
add table bridge TchainBridge
add table arp TchainArp
add chain Tchain C1
add chain ip TchainIp C2
add chain ip6 TchainIp6 C3
add chain inet TchainInet C4
add chain netdev TchainNetdev C5
add chain bridge TchainBridge C6
add chain arp TchainArp C7

delete chain Tchain C1
delete chain ip TchainIp C2
delete chain ip6 TchainIp6 C3
delete chain inet TchainInet C4
delete chain netdev TchainNetdev C5
delete chain bridge TchainBridge C6
delete chain arp TchainArp C7

add chain Tchain C11
add chain Tchain C11
add chain ip TchainIp C12
add chain ip6 TchainIp6 C13
add chain inet TchainInet C14
add chain netdev TchainNetdev C15
add chain bridge TchainBridge C16
add chain arp TchainArp C17
delete chain Tchain C11 { }
delete chain ip TchainIp C12 {  }
delete chain ip6 TchainIp6 C13 {  }
delete chain inet TchainInet C14 {  }
delete chain netdev TchainNetdev C15 {  }
delete chain bridge TchainBridge C16 {  }
delete chain arp TchainArp C17 { }

add chain Tchain C
delete chain Tchain C { define my_var = 1; };


# delete rule <ruleid_spec>
delete rule T C handle 16
delete rule last C handle 16
delete rule T last handle 16
delete rule last last handle 16
delete rule arp T C handle 16
delete rule bridge T C handle 16
delete rule filter output handle 5

delete rule inet T C handle 16
delete rule ip6 T C handle 16
delete rule ip T C handle 42
delete rule netdev T C handle 16
delete rule T C handle 42



# delete set <set_spec>
delete set T S
delete set ip T S
delete set ip6 T S
delete set inet T S
delete set netdev T S
delete set bridge T S
delete set arp T S

# delete set <setid_spec>
delete set T handle 123
delete set ip T handle 123
delete set inet T handle 42  # comment

# delete map <set_spec>
delete map T M 
delete map ip T M 
delete map ip6 T M 
delete map inet T M 
delete map netdev T M 
delete map bridge T M 
delete map arp T M 

add table T;
add set T M { type inet_service; };
add set T M1 { type inet_service; };

# delete element <set_spec> <set_block_expr>
delete element T M1 { ssh };


# 'delete' 'flowtable' <flowtable_spec>
# common_block->flowtable_block->'{'->'flowtable'->delete_cmd->'delete'->base_cmd->line
delete flowtable T FT 
delete flowtable ip T FT 
delete flowtable ip6 T FT 
delete flowtable inet T FT 
delete flowtable netdev T FT 
delete flowtable bridge T FT 
delete flowtable arp T FT 

delete flowtable T FT { define my_var = 1; };
delete flowtable T FT { hook input priority 0; devices = { br0, eth0, eth1} ; }
delete flowtable ip T FT { hook input priority 0; devices = { eth0, eth1 } ; }
delete flowtable ip6 T FT { hook input priority 0; devices = { br0, eth0 } ; }
delete flowtable inet T FT { hook input priority 0; devices = { br0, eth1 } ; }

delete flowtable bridge T FT { hook input priority 0; devices = { br0, eth1 } ; }
delete flowtable arp T FT { hook input priority 0; devices = { br0, eth1 } ; }

delete flowtable T handle 15 
delete flowtable ip T handle 15
delete flowtable ip6 T handle 15 
delete flowtable inet T handle 15 
delete flowtable netdev T handle 15 
delete flowtable bridge T handle 15 
delete flowtable arp T handle 15 

# delete quota <obj_spec>
delete quota T Q 
delete quota ip T Q
delete quota ip6 T Q
delete quota inet T Q
delete quota netdev T Q
delete quota bridge T Q
delete quota arp T Q

# delete quota <objid_spec>
delete quota T handle 15
delete quota ip T handle 15
delete quota ip6 T handle 15
delete quota inet T handle 123
delete quota netdev T handle 15
#delete quota inet T index 345  # not yet available
#delete quota inet T position 234  # not yet available
delete quota bridge T handle 15
delete quota arp T handle 15

delete secmark arp T handle 15
delete secmark arp T secmark_name
delete secmark bridge T handle 15
delete secmark bridge T secmark_name
delete secmark inet T handle 15
delete secmark inet T secmark_name
delete secmark ip6 T handle 15
delete secmark ip6 T secmark_name
delete secmark ip T handle 15
delete secmark ip T secmark_name
delete secmark netdev T handle 15
delete secmark netdev T secmark_name
delete secmark T handle 15
delete secmark T secmark_name 

delete synproxy arp T handle 15
delete synproxy arp T synproxy_name
delete synproxy bridge T handle 15
delete synproxy bridge T synproxy_name
delete synproxy inet T handle 15
delete synproxy inet T synproxy_name
delete synproxy ip6 T handle 15
delete synproxy ip6 T synproxy_name
delete synproxy ip T handle 15
delete synproxy ip T synproxy_name
delete synproxy netdev T handle 15
delete synproxy netdev T synproxy_name
delete synproxy T handle 15
delete synproxy T synproxy_name 


