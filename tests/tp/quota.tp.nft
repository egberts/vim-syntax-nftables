#!/usr/sbin/nft -f
# File: quota.nft
# Description: Test NFT file to exercise '[add] quota' Vim syntax highlightings.
#
# base_cmd add_cmd 'quota'
# nft_line/nft_base_cmd/nft_base_cmd_add/nft_base_cmd_add_quota
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################

# quota statements
add table filter
add quota filter http_quota 25 mbytes
add quota filter ssh_quota { 10 kbytes }
add quota filter http_quota { 25 mbytes };

add table T
add table ip Tip
add table ip6 Tip6
add table inet Tinet
add table netdev Tnetdev
add table bridge Tbridge
add table arp Tarp
add quota T Q 500 mbytes
add quota ip Tip Qip 500 mbytes
add quota ip6 Tip6 Qip6 525 kbytes
add quota inet Tinet Qinet 25 mbytes
add quota netdev Tnetdev Qnetdev 25 mbytes;
add quota bridge Tbridge Qbridge 25 mbytes
add quota arp Tarp Qarp 25 mbytes
delete quota T Q
delete quota ip Tip Qip
delete quota ip6 Tip6 Qip6
delete quota inet Tinet Qinet
delete quota netdev Tnetdev Qnetdev
delete quota bridge Tbridge Qbridge
delete quota arp Tarp Qarp

create quota T Q 25 mbytes
create quota ip Tip Qip 25 mbytes
create quota ip6 Tip6 Qip6 525 kbytes
create quota inet Tinet Qinet 25 mbytes
create quota netdev Tnetdev Qnetdev 25 mbytes;
create quota bridge Tbridge Qbridge 25 mbytes
create quota arp Tarp Qarp 25 mbytes

list quota T Q
list quota ip Tip Qip
list quota ip6 Tip6 Qip6
list quota inet Tinet Qinet
list quota netdev Tnetdev Qnetdev
list quota bridge Tbridge Qbridge
list quota arp Tarp Qarp

list quotas
list quotas ip
list quotas ip6
list quotas inet
list quotas netdev
list quotas bridge
list quotas arp
list quotas table T
list quotas table ip Tip
list quotas table ip6 Tip6
list quotas table inet Tinet
list quotas table netdev Tnetdev
list quotas table bridge Tbridge
list quotas table arp Tarp

reset quota T Q
reset quota ip Tip Qip
reset quota ip6 Tip6 Qip6
reset quota inet Tinet Qinet
reset quota netdev Tnetdev Qnetdev
reset quota bridge Tbridge Qbridge
reset quota arp Tarp Qarp

reset quotas 
reset quotas T
reset quotas ip Tip
reset quotas ip6 Tip6
reset quotas inet Tinet
reset quotas netdev Tnetdev
reset quotas bridge Tbridge
reset quotas arp Tarp

reset quotas table T
reset quotas table ip Tip
reset quotas table ip6 Tip6
reset quotas table inet Tinet
reset quotas table netdev Tnetdev
reset quotas table bridge Tbridge
reset quotas table arp Tarp

# quota expressions
# base_cmd add_cmd 'table' table_spec table_block 'quota' quota_block
table T {
    quota Q1 {
        # comment_spec
        include "../include/comment-just-a-comment.nft";
        # quota_config
        15 mbytes
        # common_block
        define A = 1
        redefine A = 2
        undefine A
    }
    quota last { };  # not a pre-defined 'last' keyword, but a 'last' identifier
}

table T {
    quota Q2 {
        # quota_config
        over 25 kbytes
    }
}

table T {
    quota Q3 {
        # quota_config
        until 30 kbytes
    }
}



table T {
    quota Q {
    };
};
table T {
    quota Q {
    }
};
table T { quota Q { }; };
table ip T { quota Q { }; }
table ip6 T { quota Q { }; }
table inet T { quota Q { }; }
table netdev T { quota Q { }; }
table bridge T { quota Q { }; }
table arp T { quota Q { }; }
table T { quota Q { 15 bytes }; }
table T { quota Q { 15 bytes used 15 bytes }; }
table T { quota Q { over 15 bytes used 15 bytes }; }
table T { quota Q { until 15 bytes }; }
table T { quota Q { until 15 bytes used 15 bytes }; }

delete quota T Q
delete quota ip Tip Qip
delete quota ip6 Tip6 Qip6
delete quota inet Tinet Qinet
delete quota netdev Tnetdev Qnetdev
delete quota bridge Tbridge Qbridge
delete quota arp Tarp Qarp

