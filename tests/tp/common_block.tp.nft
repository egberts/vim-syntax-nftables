#!/usr/sbin/nft -f
# File: common_block.nft
# Description: A test NFT file to exercise common_block Vim syntax group.
#
# nft_line/nft_common_block
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################
;
 ;
;
 ;

# line/common_block/INCLUDE
include "../include/add-table-a.nft"

# line/common_block/INCLUDE/stmt_separator
include "../include/add-table-a.nft";
include "../include/add-table-a.nft";
include "../include/add-table-a.nft" ;
include "../include/add-table-a.nft" ;

# line common_block 'define' identifier '=' initializer_expr
# line/common_block/DEFINE
define A=1
define B= 1
define C =1
define D = 1
define lastA=1
define lastB= 1
define lastC =1
define lastD = 1
define ABC= 1  # missing stmt_separator
define ABD = 1  ;
define ABE = 1, 2, 3  ;  # set
define ABF = 127.0.0.1  # missing stmt_separator
define ABG = 127.0.0.1;
define ABH = 127.0.0.1, 192.168.1.1;  # set
define ABI =-1   # missing stmt_separator
define ABJ = -1   # missing stmt_separator
define ABK = -1;
define ABL = -1;
define ABM = -1 ;
define ABN = -1 ;
define port_range = 1024-32767
define port_rangeA = 1024-32767 ;
define ABO = identifier # missing stmt_separator
define ABP = identifier ;
define my_identifier = "ACC";
define ABQ = $my_identifier # missing stmt_separator
define ABR = $my_identifier;
define ABS = "string"  # missing stmt_separator
define ABT = "string";

# line/common_block/DEFINE/initializer_expr/rhs_expr/.../primary_rhs_expr/set_expr/{}
define ABU = {};
define last = {   }
define ABV = { }
define ABW = { }
define ABX = {            }

# Set section
define ABY = { 1 };
define MY_SET_A = { 1, 2 }
define MY_SET_B = { 1, 2, 3, 4 };

define MY_IP_SET_A = { 127.0.0.1 };
define MY_IP_SET_B = { 127.0.0.1, 192.168.1.1, 192.168.10.10 };

define ABZ = { x };
define MY_PORTS = { test };
define MY_PORTS_SET = { test, ssh, tcp, icmp };

define MY_DEV = { "eth0" };

define MY_PORT_RANGE = { 1024-2048 };

# Map section
define MY_MAP_A = { 1:1 };
define MY_MAP_B = { 1:tcp };
define MY_MAP_C = { 1:"abc" };
define MY_MAP_D = { 1 : "abc" };
define MY_MAP_E = { 1:"eth0",  2:"br0" };
define MY_MAP_F = { tcp : tcp };
define MY_MAP_G = { eth0:127.0.0.1 };
define MY_MAP_H = { eth0 : 127.0.0.1 };
define MY_MAP_I = { eth0:127.0.0.1, bro0:192.168.1.1 };
define MY_MAP_J = { 192.168.20.20: ssh };
define MY_MAP_K = { 192.168.20.20: ssh, 127.0.0.1: http };
define MY_MAP_L = { 192.168.20.20: 127.0.0.1 };
define MY_MAP_M = { 192.168.20.20: 127.0.0.1, 127.0.0.1: 127.0.0.1};

# line/common_block/DEFINE/initializer_expr/DASH_NUM
define negative_valueA = -1000
define negative_valueB = -1000 ;
#
# line common_block 'redefine' identifier '=' initializer_expr
# line/common_block/REDEFINE
redefine last = {}
redefine A = {}
redefine A={}
redefine last = {}
redefine A = { 1 }
redefine A = { 1,2, 3, 4 }
redefine A = { 127.0.0.1 }
redefine A = { 127.0.0.1, 192.168.1.7 }
redefine A = { };
redefine A = { x }; 
redefine A = { } ;
redefine A = { } ; 
redefine A = 2
redefine A = 123  # missing stmt_separator
redefine A = -123  # missing stmt_separator
redefine A = $ABC  # missing stmt_separator

# line common_block 'undefine' identifier 
# line/common_block/UNDEFINE
undefine last
undefine last;
undefine last; 
undefine last ; 
undefine A
undefine ABC
# line/common_block/UNDEFINE/stmt_separator
undefine A;

undefine A_BCDE;
undefine A123DF; 
undefine A123DG ;
undefine A123DH ; 


# base_cmd add_cmd 'table' table_spec table_block common_block 'include'
table T {
    include "../include/comment-just-a-comment.nft"
}

# base_cmd add_cmd 'table' table_spec table_block common_block 'define'
table T { define A = 1; }
table T {
    define BAA = 1
    define BAB = 1 ;
    define lastBBA = 1
    define lastBBB = 1 ;
    define BAC = {} ;
}
# base_cmd add_cmd 'table' table_spec table_block common_block 'redefine'

table T { redefine A = 1; }
table T {
    redefine A = 1
    redefine A = 1 ;
}
# base_cmd add_cmd 'table' table_spec table_block common_block 'undefine'
table T {
    undefine A
    undefine B
}
table xxxx { undefine abc ; }
table xxxx { undefine abc ; } ;

# base_cmd add_cmd 'table' table_spec table_block table_options 'comment'
# base_cmd add_cmd 'table' table_spec table_block 'comment' string
table T {
    comment Hello
}



# base_cmd add_cmd 'table' table_spec table_block 'policy' 'offload'
# base_cmd add_cmd 'table' table_spec table_block hook_spec 'type'
# base_cmd add_cmd 'table' table_spec table_block 'flags' flag_spec

table T {flags dormant;}


# base_cmd add_cmd 'table' table_spec table_block { table_options ';' }


table myIpTable { flags dormant; }
table netdev myNetdev { flags dormant; }
table bridge myBridge { flags dormant; }
table arp myArpTable { flags dormant; }
table ip myIpTable { flags dormant; }
table ip6 myIp6Table { flags dormant; }
table inet myInetTable { flags dormant; }


