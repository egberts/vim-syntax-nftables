################################################################################
# true negative test: properly hightlighted wrongly to show an error; 
# so far, so good.
################################################################################

delete 


delete something

delete ;

delete table ;

delete table not_family_but_table junk2 junk3

delete table T unexpected_chain
delete table ip T unexpected_chain
delete table ip6 T unexpected_chain
delete table inet T unexpected_chain
delete table netdev T unexpected_chain
delete table bridge T unexpected_chain
delete table arp T unexpected_chain
delete table handle invalid_number
delete table ip handle 123
delete table ip6 handle 123
delete table inet handle 123
delete table netdev handle 123
delete table bridge handle 123
delete table arp handle 123

add table ip Tip
delete table ip last

delete table ip handle 7
delete table ip6 handle 8
delete table inet handle 9
delete table netdev handle 10
delete table bridge handle 11
delete table arp handle 12

# delete chain <chainid_spec>
# common_block->chain_block->'{'->'chain'->delete_cmd->'delete'->base_cmd->line
delete chain T C
delete chain ip T C
delete chain ip6 T C
delete chain inet T C
delete chain netdev T C
delete chain bridge T C
delete chain arp T C

delete chain T C { }
delete chain ip T C {  }
delete chain ip6 T C {  }
delete chain inet T C {  }
delete chain netdev T C {  }
delete chain bridge T C {  }
delete chain arp T C { }

delete chain T C { define my_var; };


delete chain T handle 123123
delete chain ip T handle 15
delete chain inet T handle 15
delete chain inet T handle 42  # comment
delete chain ip6 T handle 15
delete chain bridge T handle 15
delete chain arp T handle 15
delete chain netdev T handle 15

# delete rule <ruleid_spec>
delete rule T C handle 16
delete rule last C handle 16
delete rule T last handle 16
delete rule last last handle 16
delete rule arp T C handle 16
delete rule bridge T C handle 16
delete rule filter output handle 5
delete rule filter output ip saddr 192.168.1.1 counter  # not implemented yet
delete rule inet T C handle 16
delete rule ip6 T C handle 16
delete rule ip T C handle 42
delete rule netdev T C handle 16
delete rule T C handle 42

# delete set <set_spec>
delete set T S
delete set ip T S
delete set ip6 T S
delete set inet T S
delete set netdev T S
delete set bridge T S
delete set arp T S

# delete set <setid_spec>
delete set T handle 123
delete set ip T handle 123
delete set inet T handle 42  # comment

# delete map <set_spec>
delete map T M 
delete map ip T M 
delete map ip6 T M 
delete map inet T M 
delete map netdev T M 
delete map bridge T M 
delete map arp T M



# delete element <set_spec> <set_block_expr>
delete element T M { elements = { element, element }; }
delete element ip T M { element, element }
delete element ip T M { elements = { element, element } ; }
delete element ip6 T M { element, element }
delete element ip6 T M { elements = { element, element } ; }
delete element inet T M { element, element }
delete element inet T M { elements = { element, element } ; }
delete element netdev T M { element, element }
delete element netdev T M { elements = { element, element } ; }
delete element bridge T M { element, element }
delete element bridge T M { elements = { element, element } ; }
delete element arp T M { element, element }
delete element arp T M { elements = { element, element } ; }

# 'delete' 'flowtable' <flowtable_spec>
# common_block->flowtable_block->'{'->'flowtable'->delete_cmd->'delete'->base_cmd->line
add table Tnetdev
add table Tbridge
add table Tarp
add flowtable netdev Tnetdev FTnetdev { hook ingress priority 0; devices = { eno2 }; }
add flowtable bridge Tbridge FTbridge { hook ingress priority 0; devices = { eno2 }; }
add flowtable arp Tarp FTarp { hook ingress priority 0; devices = { eno2 }; };
delete flowtable netdev T FT { flowtable_block }
delete flowtable bridge T FT { hook input priority 0; devices = { br0, eth1 } ; }
delete flowtable arp T FT { hook input priority 0; devices = { br0, eth1 } ; }

add table Tnetdev
add table Tbridge
add table Tarp
add flowtable netdev Tnetdev FTnetdev { hook ingress priority 0; devices = { eno2 }; }
add flowtable bridge Tbridge FTbridge { hook ingress priority 0; devices = { eno2 }; }
add flowtable arp Tarp FTarp { hook ingress priority 0; devices = { eno2 }; };
# delete flowtable netdev Tnetdev FTnetdev { hook ingress priority 0; devices = { eno2 }; }
# delete flowtable bridge Tbridge FTbridge { hook input priority 0; devices = { br0, eth1 } ; }
# delete flowtable arp Tarp FTarp { hook input priority 0; devices = { br0, eth1 } ; }

delete flowtable netdev T handle 15
delete flowtable bridge T handle 15 
delete flowtable arp T handle 15 

# delete quota <obj_spec>
delete quota T Q 
delete quota ip T Q
delete quota ip6 T Q
delete quota inet T Q
delete quota netdev T Q
delete quota bridge T Q
delete quota arp T Q

# delete quota <objid_spec>
delete quota T handle 15
delete quota ip T handle 15
delete quota ip6 T handle 15
delete quota inet T handle 123
delete quota netdev T handle 15
#delete quota inet T index 345  # not yet available
#delete quota inet T position 234  # not yet available
delete quota bridge T handle 15
delete quota arp T handle 15

add table ip T
add secmark T SM { "system_u:object_r:ssh_server_packet_t:s0" }  # fails, family_spec required
delete secmark T SM

delete secmark T synproxy_name  # must supply family_spec

delete secmark arp T secmark_name
delete secmark bridge T secmark_name
delete secmark inet T secmark_name
delete secmark ip6 T secmark_name
delete secmark ip T secmark_name
delete secmark netdev T secmark_name
delete secmark T secmark_name


add table inet Tnetdev
add table inet Tbridge
add table inet Tarp
add synproxy netdev Tnetdev SPnetdev mss 1593 wscale 1
add synproxy bridge Tbridge SPbridge mss 1518 wscale 3;
add synproxy arp Tarp SParp mss 1512  wscale 2;
delete synproxy netdev Tnetdev SPnetdev
delete synproxy bridge Tbridge SPbridge
delete synproxy arp Tarp SParp

 delete quantum

delete rule 


delete rule ; 


delete rule 0asddf 


delete rule  T 


delete rule  T  C 


delete rule  T  C  handy_dandy

delete rule  T  C  handle 


delete map 


delete map T 

