#!/usr/sbin/nft -f
# File: secmark.nft
# Description: A test NFT file to exercise 'secmark' Vim syntax highlightings.
#
# base_cmd 'secmark'
# base_cmd add_cmd 'secmark'
# nft_line/nft_base_cmd/nft_base_cmd_add/nft_base_cmd_keyword_secmark
#
################################################################################
# true positive test: properly hightlighted correctly; has good content; perfect
################################################################################
add secmark T SM { }
add secmark T SM { }
add secmark T SM {;}
add secmark T SM { ; }
add secmark T SM { define my_var = 1; };
add secmark T SM { redefine my_var = 2; };
add secmark T SM { undefine my_var; };
add secmark T SM { typeof b.c.d.e.f : secmark  };
add secmark myTable sshtag { "system_u:object_r:ssh_server_packet_t:s0" }

secmark obj_spec secmark_obj { }
secmark obj_spec secmark_obj { } 
secmark obj_spec secmark_obj {;} 
secmark obj_spec secmark_obj { ; } 
secmark T SM { define my_var = 1; };
secmark T SM { redefine my_var = 2; };
secmark T SM { undefine my_var; };
secmark T SM { typeof b.c.d.e.f : secmark  };
secmark myTable sshtag { "system_u:object_r:ssh_server_packet_t:s0" }


# base_cmd add_cmd 'table' table_spec table_block 'secmark' secmark_block
table T { secmark SM { ; }; };
table T { secmark SM { } }
table ip T { secmark SM { } }
table ip6 T { secmark SM { } }
table inet T { secmark SM { } }
table netdev T { secmark SM { } }
table bridge T { secmark SM { } }
table arp T { secmark SM { } }
table last { secmark SM { } }
table T { secmark SM { "some security settings goes into here" } }
table T {
    secmark SM {
        # common_block
        include "/directory/subdirectory/filename.filetype"
        define A = 1
        redefine A = 2
        undefine A
    }
};

create secmark myTable mySecMark 'asdf \'asdd"asdfdf'
create secmark myTable mySecMark 'asdf \'asddfasdfdf'
create secmark myTable mySecMark 'a:;fasddfa()fdf' ;
create secmark myTable mySecMark "asdf \"dfa[]fdf"
create secmark myTable mySecMark "asdf \"dfa'dfdf"
create secmark ip myTable mySecMark an unconstrained string
create secmark inet myTable mySecMark an unconstrained string ;
create secmark obj_spec secmark_obj secmark_config close_scope_secmark

delete secmark T secmark_name 
delete secmark table_name secmark_name 
delete secmark ip table_name secmark_name
delete secmark ip6 table_name secmark_name
delete secmark inet table_name secmark_name
delete secmark arp table_name secmark_name
delete secmark bridge table_name secmark_name
delete secmark netdev table_name secmark_name
delete secmark T handle 15
delete secmark table_name handle 15
delete secmark ip table_name handle 15
delete secmark ip6 table_name handle 15
delete secmark inet table_name handle 15
delete secmark arp table_name handle 15
delete secmark bridge table_name handle 15
delete secmark netdev table_name handle 15

destroy secmark arp T handle 15
destroy secmark arp T secmark_name
destroy secmark bridge T handle 15
destroy secmark bridge T secmark_name
destroy secmark inet T handle 15
destroy secmark inet T secmark_name
destroy secmark ip6 T handle 15
destroy secmark ip6 T secmark_name
destroy secmark ip T handle 15
destroy secmark ip T secmark_name
destroy secmark netdev T handle 15
destroy secmark netdev T secmark_name

list secmark table ruleset_spec
list secmark table table_name
list secmark table_id secmark_id
list secmark ip table_id secmark_id
list secmark ip6 table_id secmark_id
list secmark inet table_id secmark_id
list secmark netdev table_id secmark_id
list secmark bridge table_id secmark_id
list secmark arp table_id secmark_id

list secmarks 
list secmarks ip 
list secmarks ip6
list secmarks inet 
list secmarks netdev 
list secmarks bridge
list secmarks arp 
list secmarks table table_id
list secmarks table ip table_id
list secmarks table ip6 table_id
list secmarks table inet table_id
list secmarks table netdev table_id
list secmarks table bridge table_id
list secmarks table arp table_id

add rule T C ct secmark;
add rule ip6 myTable myChain position 1 ct secmark set ip6 myIpTable myCTHchain { };
add rule ip6 table_id myChain position 1 ct secmark zone set ip6 table_id myCTHchain { };


################################################################################
# true negative test: properly hightlighted wrongly to show an error;
# so far, so good)
################################################################################

secmark 


secmark;

secmark ;

secmark table_id
secmark table_id ;
secmark myTable mySecMark
secmark obj_spec secmark_obj { unknwon_secmark_block } 

add secmark table_id

destroy secmark 


destroy secmark T 


destroy secmark T handle 


destroy secmark ip7 T handle 15

list secmark 


list secmark ip
list secmark ip 


list secmarks ip 123
list secmarks bridge xxx



list secmark bad_table  


list secmark bad=table secmark_name 0x10
list secmark table bad=secmark_name 0x1
list secmark table secmark_name oopsie
list secmark table ip table_name
list secmark table ip6 table_name
list secmark table inet table_name
list secmark table arp table_name
list secmark table bridge table_name
list secmark table netdev table_name


################################################################################
# false negative test: highlighted wrongly; still has good content; oops.
################################################################################


################################################################################
# false positive test: looks highlighted correctly; has bad content; oops.
################################################################################

secmark table_id 
secmark myTable mySecMark 
secmark myTable mySecMark ;

add secmark table_id 
add secmark myTable mySecMark 
add secmark myTable mySecMark ;
add secmark T SM { define my_var =  }; };


